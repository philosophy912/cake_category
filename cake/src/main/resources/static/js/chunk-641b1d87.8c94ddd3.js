(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-641b1d87"],{"01d7":function(t,e,a){"use strict";var o=a("7dc7"),n=a("c223"),r=a("aec8");t.exports=function(t,e,a){var i=o(e);i in t?n.f(t,i,r(0,a)):t[i]=a}},"021b":function(t,e,a){"use strict";var o=a("407d").forEach,n=a("fb11"),r=a("6885"),i=n("forEach"),l=r("forEach");t.exports=i&&l?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},2688:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"productForm"},[a("el-form",{attrs:{model:t.row}},[a("el-form-item",{attrs:{label:"名称","label-width":"100px",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.name,callback:function(e){t.$set(t.row,"name",e)},expression:"row.name"}})],1),a("el-form-item",{attrs:{label:"数量","label-width":"100px",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.capacity,callback:function(e){t.$set(t.row,"capacity",e)},expression:"row.capacity"}})],1),a("el-form-item",{attrs:{label:"单位","label-width":"100px",required:""}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:t.row.unit,callback:function(e){t.$set(t.row,"unit",e)},expression:"row.unit"}})],1),a("Product",{attrs:{formulas:t.row.formulas,materialOptions:t.materialOptions,productOptions:t.productOptions},on:{add:t.add,del:t.del}})],1)],1)},n=[],r=(a("86dd"),a("c1b0"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product"},t._l(t.formulas,(function(e,o){return a("el-form-item",{key:o,attrs:{label:e.type,"label-width":"100px"}},[a("el-col",{attrs:{span:6}},[t.show(e)?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.id,callback:function(a){t.$set(e,"id",a)},expression:"formula.id"}},t._l(t.materialOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1):a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.id,callback:function(a){t.$set(e,"id",a)},expression:"formula.id"}},t._l(t.productOptions,(function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1),a("el-col",{staticClass:"count",staticStyle:{"text-align":"center"},attrs:{span:2}},[a("span",[t._v("数量")])]),a("el-col",{attrs:{span:8}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.count,callback:function(a){t.$set(e,"count",a)},expression:"formula.count"}})],1),a("el-col",{staticClass:"buttons",staticStyle:{"text-align":"right"},attrs:{span:8}},[a("el-button",{attrs:{type:"danger",size:"medium",icon:"el-icon-remove-outline"},on:{click:function(e){return t.del(o)}}}),a("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-circle-plus-outline"},on:{click:function(a){return t.add(e.type)}}})],1)],1)})),1)}),i=[],l=a("c4a4"),c=a.n(l),u=new c.a("components/product/product"),s={name:"FromProduct",props:{materialOptions:{type:Array},productOptions:{type:Array},formulas:{type:Array}},methods:{show:function(t){return t.type===this.$tools.MaterialName},add:function(t){u.debug("click add button"),this.$emit("add",t)},del:function(t){u.debug("click del button"),this.$emit("del",t)}}},d=s,f=a("e90a"),p=Object(f["a"])(d,r,i,!1,null,null,null),m=p.exports,h=new c.a("components/product/form"),b={name:"ProductFrom",components:{Product:m},data:function(){return{}},props:{row:{type:Object},materialOptions:{type:Array},productOptions:{type:Array},leave:{type:Boolean,default:!1},dialogType:{type:String}},computed:{materials:function(){var t=this;return this.row.formulas.filter((function(e){return e.type===t.$tools.MaterialName}))},products:function(){var t=this;return this.row.formulas.filter((function(e){return e.type===t.$tools.BasicName}))}},methods:{del:function(t){this.row.formulas.splice(t,1),h.debug("materials length is "+JSON.stringify(this.row.formulas.length))},add:function(t){h.debug("type is "+JSON.stringify(t)),t===this.$tools.MaterialName?this.row.formulas.push(this.$tools.createMaterial()):t===this.$tools.BasicName&&this.row.formulas.push(this.$tools.createProduct())}}},g=b,y=Object(f["a"])(g,o,n,!1,null,null,null);e["a"]=y.exports},"80d7":function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[t.showTable?a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.data,border:""}},[a("el-table-column",{attrs:{fixed:"",type:"expand"},scopedSlots:t._u([{key:"default",fn:function(t){return[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.row.formulas,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"type",label:"类别"}}),a("el-table-column",{attrs:{prop:"count",label:"数量"}}),a("el-table-column",{attrs:{prop:"price",label:"总价"}})],1)]}}],null,!1,208065735)}),a("el-table-column",{attrs:{fixed:"",prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),a("el-table-column",{attrs:{prop:"capacity",label:"数量"}}),a("el-table-column",{attrs:{prop:"price",label:"总价(元)"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"300"},scopedSlots:t._u([{key:"header",fn:function(e){return[a("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},on:{change:function(a){return t.search(e.row)}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:function(a){return t.search(e.row)}},slot:"append"})],1)]}},{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-edit"},on:{click:function(a){return t.modify(e.row)}}},[t._v("修改 ")]),a("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-document-add"},on:{click:function(e){return t.add()}}},[t._v("新增 ")]),a("el-button",{attrs:{type:"danger",size:"small",icon:"el-icon-document-add"},on:{click:function(a){return t.del(e.row)}}},[t._v("删除 ")])]}}],null,!1,600719121)})],1):t._e()],1)},n=[],r=a("c4a4"),i=a.n(r),l=new i.a("components/product/table"),c={name:"ProductTable",data:function(){return{content:""}},props:{data:{type:Array}},computed:{showTable:function(){return 0!=this.data.length}},methods:{modify:function(t){l.debug("click modify button"),this.$emit("modify",t)},add:function(){l.debug("click add button"),this.$emit("add")},del:function(t){l.debug("click del button"),this.$emit("del",t)},search:function(t){l.debug("it will search content["+this.content+"]"),this.$emit("search",this.content)}}},u=c,s=a("e90a"),d=Object(s["a"])(u,o,n,!1,null,null,null);e["a"]=d.exports},"86dd":function(t,e,a){"use strict";var o=a("91fe"),n=a("407d").filter,r=a("b1a1"),i=a("6885"),l=r("filter"),c=i("filter");o({target:"Array",proto:!0,forced:!l||!c},{filter:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},"8a8e":function(t,e,a){"use strict";a.d(e,"d",(function(){return f})),a.d(e,"c",(function(){return p})),a.d(e,"e",(function(){return m})),a.d(e,"a",(function(){return h})),a.d(e,"b",(function(){return b}));a("c354");var o=a("b775"),n=a("c4a4"),r=a.n(n),i=(new r.a("api/middle"),"/middle/"),l=i+"query",c=i+"queryName?name=",u=i+"add",s=i+"update",d=i+"delete",f=function(){return Object(o["a"])({url:l,method:"get"})},p=function(t){return Object(o["a"])({url:c+t,method:"get"})},m=function(t){var e={id:t.id,name:t.name,unit:t.unit,capacity:t.capacity,formulas:t.formulas};return Object(o["a"])({url:s,method:"post",data:e})},h=function(t){var e={name:t.name,unit:t.unit,capacity:t.capacity,formulas:t.formulas};return Object(o["a"])({url:u,method:"post",data:e})},b=function(t){var e={id:t.id};return Object(o["a"])({url:d,method:"post",data:e})}},"9a14":function(t,e,a){var o=a("d5dc"),n=a("41f6"),r=a("021b"),i=a("2ba5");for(var l in n){var c=o[l],u=c&&c.prototype;if(u&&u.forEach!==r)try{i(u,"forEach",r)}catch(s){u.forEach=r}}},af82:function(t,e,a){"use strict";var o=a("91fe"),n=a("021b");o({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},b1a1:function(t,e,a){var o=a("f30e"),n=a("57c4"),r=a("bf98"),i=n("species");t.exports=function(t){return r>=51||!o((function(){var e=[],a=e.constructor={};return a[i]=function(){return{foo:1}},1!==e[t](Boolean).foo}))}},c1b0:function(t,e,a){"use strict";var o=a("91fe"),n=a("0192"),r=a("f240"),i=a("684e"),l=a("ee6f"),c=a("3132"),u=a("01d7"),s=a("b1a1"),d=a("6885"),f=s("splice"),p=d("splice",{ACCESSORS:!0,0:0,1:2}),m=Math.max,h=Math.min,b=9007199254740991,g="Maximum allowed length exceeded";o({target:"Array",proto:!0,forced:!f||!p},{splice:function(t,e){var a,o,s,d,f,p,y=l(this),v=i(y.length),w=n(t,v),O=arguments.length;if(0===O?a=o=0:1===O?(a=0,o=v-w):(a=O-2,o=h(m(r(e),0),v-w)),v+a-o>b)throw TypeError(g);for(s=c(y,o),d=0;d<o;d++)f=w+d,f in y&&u(s,d,y[f]);if(s.length=o,a<o){for(d=w;d<v-o;d++)f=d+o,p=d+a,f in y?y[p]=y[f]:delete y[p];for(d=v;d>v-o+a;d--)delete y[d-1]}else if(a>o)for(d=v-o;d>w;d--)f=d+o-1,p=d+a-1,f in y?y[p]=y[f]:delete y[p];for(d=0;d<a;d++)y[d+w]=arguments[d+2];return y.length=v-o+a,s}})},df3a:function(t,e,a){"use strict";var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"productDialog"},[a("el-dialog",{attrs:{title:t.dialog.title,visible:t.dialog.show,"show-close":!1},on:{"update:visible":function(e){return t.$set(t.dialog,"show",e)}}},[a("ProductForm",{attrs:{row:t.dialog.row,dialogType:t.dialog.type,materialOptions:t.materialOptions,productOptions:t.productOptions,leave:!0},on:{add:t.add}}),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"success",icon:"el-icon-document-add"},on:{click:function(e){return t.add()}}},[t._v("新增配方")]),a("el-button",{on:{click:function(e){return t.cancle()}}},[t._v(t._s(t.dialog.left))]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.confirm()}}},[t._v(t._s(t.dialog.right))])],1)],1)],1)},n=[],r=(a("af82"),a("c354"),a("9a14"),a("f98d")),i=a("8a8e"),l=a("2688"),c=a("c4a4"),u=a.n(c),s=new u.a("components/product/dialog"),d={name:"ProductDialog",components:{ProductForm:l["a"]},props:{materialOptions:{type:Array},productOptions:{type:Array},dialog:{type:Object}},methods:{cancle:function(){s.info("cancle button on"),this.closeDialog()},getUpdateData:function(){var t=[];this.dialog.row.formulas.forEach((function(e){var a={fid:e.fid,count:e.count,type:e.type,id:e.id,pid:e.pid};t.push(a)})),s.debug("formulas is "+JSON.stringify(t));var e={id:this.dialog.row.id,name:this.dialog.row.name,unit:this.dialog.row.unit,capacity:this.dialog.row.capacity,formulas:t};return s.debug("data is "+JSON.stringify(e)),e},getAddData:function(){var t=[];this.dialog.row.formulas.forEach((function(e){var a={count:e.count,type:e.type,id:e.id};t.push(a)})),s.debug("formulas is "+JSON.stringify(t));var e={name:this.dialog.row.name,unit:this.dialog.row.unit,capacity:this.dialog.row.capacity,formulas:t};return s.debug("data is "+JSON.stringify(e)),e},confirm:function(){var t=this;s.info("config button on and send data to background");var e=this.dialog.type,a=this.dialog.right;if(e===this.$tools.BasicName){if(a===this.$tools.saveButton){var o=this.getUpdateData();Object(r["f"])(o).then((function(){t.$message.success("更新中级材料["+o.name+"]成功"),t.$parent.getData()}))}else if(a===this.$tools.addButton){var n=this.getAddData();Object(r["a"])(n).then((function(){t.$message.success("添加中级材料["+n.name+"]成功"),t.$parent.getData()}))}}else if(e===this.$tools.MiddleName)if(a===this.$tools.saveButton){var l=this.getUpdateData();Object(i["e"])(l).then((function(){t.$message.success("更新中级材料["+l.name+"]成功"),t.$parent.getData()}))}else if(a===this.$tools.addButton){var c=this.getAddData();Object(i["a"])(c).then((function(){t.$message.success("添加中级材料["+c.name+"]成功"),t.$parent.getData()}))}this.closeDialog()},closeDialog:function(){s.info("material Dialog closeDialog"),this.$emit("closeDialog")},add:function(){s.info("click add button"),this.$emit("add")}}},f=d,p=a("e90a"),m=Object(p["a"])(f,o,n,!1,null,null,null);e["a"]=m.exports},f98d:function(t,e,a){"use strict";a.d(e,"d",(function(){return p})),a.d(e,"c",(function(){return m})),a.d(e,"e",(function(){return h})),a.d(e,"f",(function(){return b})),a.d(e,"a",(function(){return g})),a.d(e,"b",(function(){return y}));a("c354");var o=a("b775"),n=a("c4a4"),r=a.n(n),i=(new r.a("api/basic"),"/basic/"),l=i+"query",c=i+"queryName?name=",u=i+"add",s=i+"update",d=i+"delete",f=i+"queryBasic",p=function(){return Object(o["a"])({url:f,method:"get"})},m=function(t){return Object(o["a"])({url:c+t,method:"get"})},h=function(){return Object(o["a"])({url:l,method:"get"})},b=function(t){var e={id:t.id,name:t.name,unit:t.unit,capacity:t.capacity,formulas:t.formulas};return Object(o["a"])({url:s,method:"post",data:e})},g=function(t){var e={name:t.name,unit:t.unit,capacity:t.capacity,formulas:t.formulas};return Object(o["a"])({url:u,method:"post",data:e})},y=function(t){var e={id:t.id};return Object(o["a"])({url:d,method:"post",data:e})}}}]);
//# sourceMappingURL=chunk-641b1d87.8c94ddd3.js.map